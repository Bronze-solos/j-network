<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>J-Network | Official Rankings</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-red: #dc2626;
            --ht-gold: #ffd700;
            --lt-silver: #c0c0c0;
            --bg-dark: #070202;
            --panel-bg: rgba(15, 5, 5, 0.98);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        /* ===== IMPROVED LAVA ANIMATION ===== */
        body {
            background: var(--bg-dark);
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .lava-bg {
            position: fixed;
            inset: 0;
            z-index: -2;
            background: linear-gradient(0deg, #000 0%, #200 40%, #500 50%, #200 60%, #000 100%);
            background-size: 100% 400%;
            animation: lavaSmooth 12s ease-in-out infinite;
        }

        @keyframes lavaSmooth {
            0% { background-position: 0% 0%; }
            50% { background-position: 0% 100%; }
            100% { background-position: 0% 0%; }
        }

        .glow-overlay {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at center, transparent 30%, rgba(0,0,0,0.8) 100%);
            pointer-events: none;
            z-index: -1;
        }

        /* ===== NAVIGATION ===== */
        header {
            background: rgba(0, 0, 0, 0.95);
            padding: 1.5rem 3rem;
            border-bottom: 3px solid var(--primary-red);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(15px);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-main {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            color: var(--primary-red);
            text-shadow: 3px 3px 0px #300;
        }

        nav a {
            color: #888;
            text-decoration: none;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.6rem;
            margin-left: 25px;
            transition: 0.3s;
        }

        nav a.active, nav a:hover { color: var(--primary-red); }

        /* ===== GAME MODES ===== */
        .tab-scroller {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px 0;
            border-bottom: 1px solid #222;
        }

        .tab-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 0 20px;
            scrollbar-width: none;
        }

        .mode-tab {
            padding: 10px 18px;
            background: #111;
            border: 1px solid #333;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.55rem;
            cursor: pointer;
            color: #666;
            white-space: nowrap;
        }

        .mode-tab.active { background: var(--primary-red); color: #fff; border-color: #fff; }

        /* ===== LEADERBOARD LAYOUT ===== */
        .container { max-width: 1200px; margin: 40px auto; padding: 0 20px; }

        .tier-section {
            margin-bottom: 50px;
            background: var(--panel-bg);
            border: 1px solid #222;
        }

        .tier-header {
            padding: 15px 25px;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #333;
        }

        .tier-header.t1 { background: linear-gradient(90deg, #300, #111); color: var(--ht-gold); border-bottom-color: var(--ht-gold); }
        .tier-header.t2 { background: #1a1a1a; color: #ff8c00; border-bottom-color: #ff8c00; }
        .tier-header.t3 { background: #1a1a1a; color: #ff6b35; border-bottom-color: #ff6b35; }
        .tier-header.t4 { background: #1a1a1a; color: #dc2626; border-bottom-color: #dc2626; }
        .tier-header.t5 { background: #1a1a1a; color: #881337; border-bottom-color: #881337; }

        .player-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); }

        .player-row {
            display: flex;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.03);
            position: relative;
        }

        .avatar {
            width: 48px;
            height: 48px;
            image-rendering: pixelated;
            border: 2px solid #333;
            margin-right: 20px;
            background: #111;
        }

        .player-name { font-size: 1.1rem; font-weight: bold; flex-grow: 1; }

        .badge {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.5rem;
            padding: 4px 8px;
            border-radius: 2px;
        }

        .badge-ht { color: var(--ht-gold); border: 1px solid var(--ht-gold); }
        .badge-lt { color: var(--lt-silver); border: 1px solid #444; }

        .expand-icon { color: #444; font-size: 1.2rem; cursor: default; }

        /* Overall Special Styling */
        .points-text { font-family: 'Press Start 2P', cursive; font-size: 0.6rem; color: var(--primary-red); }

        /* Community Styles */
        .comm-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .comm-box { background: var(--panel-bg); border: 1px solid #333; padding: 20px; }
    </style>
</head>
<body>

    <div class="lava-bg"></div>
    <div class="glow-overlay"></div>

    <header>
        <div class="logo-main">J-NETWORK</div>
        <nav>
            <a href="#" class="active" onclick="showPage('rankings')">RANKINGS</a>
            <a href="#" onclick="showPage('community')">COMMUNITY</a>
            <a href="https://discord.gg/zJHMadUf" target="_blank">DISCORD</a>
        </nav>
    </header>

    <div id="ranking-view">
        <div class="tab-scroller">
            <div class="tab-container" id="modeTabs"></div>
        </div>
        <div class="container" id="mainBoard"></div>
    </div>

    <div id="community-view" class="container" style="display:none;">
        <h2 style="font-family:'Press Start 2P'; margin-bottom:30px; color:var(--primary-red);">COMMUNITY HUB</h2>
        <div class="comm-grid">
            <div class="comm-box">
                <h3 style="font-family:'Press Start 2P'; font-size:0.7rem; margin-bottom:20px;">NOTABLE MEMBERS</h3>
                <div id="notable-list"></div>
            </div>
            <div class="comm-box">
                <h3 style="font-family:'Press Start 2P'; font-size:0.7rem; margin-bottom:20px;">ACTIVE EVENTS</h3>
                <p style="color:#666; font-size:0.9rem;">Season 1 Ranking Race is currently LIVE. Top HT1 in Sword takes the Mythic role.</p>
            </div>
        </div>
    </div>

    <script>
        // 1. DATA STRUCTURE (Ready for Bot API)
        const modes = ["Overall", "LTMs", "Vanilla", "UHC", "Pot", "NetherOP", "SMP", "Sword", "Axe", "Mace", "tnt Cart"];
        
        // Tier to Point Values for Overall Calculation
        const pointMap = {
            "HT1": 1000, "LT1": 800,
            "HT2": 600,  "LT2": 500,
            "HT3": 400,  "LT3": 300,
            "HT4": 200,  "LT4": 150,
            "HT5": 100,  "LT5": 50
        };

        const players = [
            { name: "BronzeHarpy80", region: "NA", ranks: { "Vanilla": "HT1", "Sword": "LT1", "Pot": "HT2" } },
            { name: "N0tsqurmyshi", region: "NA", ranks: { "Vanilla": "LT1", "Sword": "HT1", "Pot": "LT1" } },
            { name: "JeffersonD44", region: "NA", ranks: { "Vanilla": "HT1", "Sword": "LT2" } },
            { name: "NetherWarrior", region: "EU", ranks: { "NetherOP": "HT1", "Vanilla": "LT2" } }
        ];

        let activeMode = "Overall";

        // 2. CORE LOGIC
        function getSkin(user) {
            return `https://mcprofile.io/avatar/${user}`;
        }

        function handleImgError(img) {
            img.onerror = null;
            img.src = 'https://mcprofile.io/avatar/steve';
        }

        function calculateOverall() {
            return players.map(p => {
                let total = 0;
                Object.values(p.ranks).forEach(r => total += (pointMap[r] || 0));
                return { ...p, totalPoints: total };
            }).sort((a, b) => b.totalPoints - a.totalPoints);
        }

        // 3. RENDERERS
        function showPage(page) {
            document.getElementById('ranking-view').style.display = page === 'rankings' ? 'block' : 'none';
            document.getElementById('community-view').style.display = page === 'community' ? 'block' : 'none';
            document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
            event.target.classList.add('active');
        }

        function renderTabs() {
            const container = document.getElementById('modeTabs');
            container.innerHTML = '';
            modes.forEach(m => {
                const btn = document.createElement('div');
                btn.className = `mode-tab ${m === activeMode ? 'active' : ''}`;
                btn.innerText = m.toUpperCase();
                btn.onclick = () => { activeMode = m; renderTabs(); renderBoard(); };
                container.appendChild(btn);
            });
        }

        function renderBoard() {
            const board = document.getElementById('mainBoard');
            board.innerHTML = '';

            if (activeMode === "Overall") {
                renderOverall(board);
            } else {
                renderKitLeaderboard(board, activeMode);
            }
        }

        function renderOverall(board) {
            const ranked = calculateOverall();
            let html = `
            <div class="tier-section">
                <div class="tier-header t1">üèÜ OVERALL LEADERBOARD</div>
                <div class="player-list">`;
            
            ranked.forEach((p, i) => {
                html += `
                <div class="player-row">
                    <div style="margin-right:15px; font-family:'Press Start 2P'; font-size:0.6rem; color:#444;">#${i+1}</div>
                    <img src="${getSkin(p.name)}" class="avatar" onerror="handleImgError(this)">
                    <div class="player-name">${p.name}</div>
                    <div class="points-text">${p.totalPoints} PTS</div>
                </div>`;
            });
            board.innerHTML = html + `</div></div>`;
        }

        function renderKitLeaderboard(board, kit) {
            // Group players into Tiers 1-5
            const tierGroups = { 1: [], 2: [], 3: [], 4: [], 5: [] };
            
            // Step 1: Filter and group
            players.forEach(p => {
                const r = p.ranks[kit];
                if (!r) return;
                const tierNum = r.match(/\d/)[0];
                tierGroups[tierNum].push({ ...p, currentRank: r });
            });

            // Step 2: Enforce Single HT1 logic and render
            for (let i = 1; i <= 5; i++) {
                const group = tierGroups[i];
                if (group.length === 0) continue;

                // Sort: HT comes first. Only 1 HT1 per kit allowed as per instructions.
                // If the data has two HT1s, the logic demotes the second one to LT1.
                let htFound = false;
                const sortedGroup = group.sort((a, b) => (a.currentRank.startsWith('HT') ? -1 : 1));

                let html = `<div class="tier-section">
                    <div class="tier-header t${i}">TIER ${i}</div>
                    <div class="player-list">`;

                sortedGroup.forEach(p => {
                    let displayRank = p.currentRank;
                    
                    // HT1 Uniqueness Enforcer
                    if (i === 1) {
                        if (displayRank === "HT1") {
                            if (htFound) displayRank = "LT1"; // Demote extra HT1s
                            else htFound = true;
                        }
                    }

                    const isHT = displayRank.startsWith("HT");
                    html += `
                    <div class="player-row">
                        <img src="${getSkin(p.name)}" class="avatar" onerror="handleImgError(this)">
                        <div class="player-name ${isHT ? 'ht-text' : ''}">${p.name}</div>
                        <div class="badge ${isHT ? 'badge-ht' : 'badge-lt'}">${displayRank}</div>
                        <div class="expand-icon" style="margin-left:15px;">‚Ä∫</div>
                    </div>`;
                });
                board.innerHTML += html + `</div></div>`;
            }
        }

        // Initialize
        renderTabs();
        renderBoard();
        
        // Community Placeholder
        document.getElementById('notable-list').innerHTML = players.slice(0,3).map(p => 
            `<div style="margin-bottom:10px; font-size:0.8rem;">‚Ä¢ ${p.name} (${p.region})</div>`
        ).join('');
    </script>
</body>
</html>
